<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-GB">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>`RLumCarlo': Tedious features - fine examples • RLumCarlo</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="`RLumCarlo': Tedious features - fine examples">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">RLumCarlo</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.10</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/RLumCarlo_-_Getting_started_with_RLumCarlo.html">`RLumCarlo': Tedious features - fine examples</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/R-Lum/RLumCarlo/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">



<script src="RLumCarlo_-_Getting_started_with_RLumCarlo_files/kePrint-0.0.1/kePrint.js"></script><link href="RLumCarlo_-_Getting_started_with_RLumCarlo_files/lightable-0.0.1/lightable.css" rel="stylesheet">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>`RLumCarlo': Tedious features - fine examples</h1>
                        <h4 data-toc-skip class="author">Sebastian
Kreutzer, Johannes Friedrich, Vasilis Pagonis, Christoph Schmidt</h4>
            
            <h4 data-toc-skip class="date">RLumCarlo: v0.1.10 | last
modified: 2025-09-19</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/R-Lum/RLumCarlo/blob/HEAD/vignettes/RLumCarlo_-_Getting_started_with_RLumCarlo.Rmd" class="external-link"><code>vignettes/RLumCarlo_-_Getting_started_with_RLumCarlo.Rmd</code></a></small>
      <div class="d-none name"><code>RLumCarlo_-_Getting_started_with_RLumCarlo.Rmd</code></div>
    </div>

    
    
<p><img src="../reference/figures/Logo_RLumCarlo.png" width="150" style="display: block; margin: auto;"></p>
<div class="section level2">
<h2 id="scope">Scope<a class="anchor" aria-label="anchor" href="#scope"></a>
</h2>
<p>`RLumCarlo’ is a collection of energy-band models to simulate
luminescence signals in dosimetric materials using Monte-Carlo (MC)
methods for various stimulation modes. This document aims at
supplementing the package documentation and elaborating the package
examples.</p>
</div>
<div class="section level2">
<h2 id="the-models-in-rlumcarlo">The models in `RLumCarlo’<a class="anchor" aria-label="anchor" href="#the-models-in-rlumcarlo"></a>
</h2>
<div class="section level3">
<h3 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h3>
<table style="width:100%;" class="table">
<colgroup>
<col width="11%">
<col width="20%">
<col width="15%">
<col width="18%">
<col width="18%">
<col width="16%">
</colgroup>
<thead><tr class="header">
<th>TRANSITION</th>
<th>BASE MODEL</th>
<th>IRSL</th>
<th>OSL</th>
<th>LM-OSL</th>
<th>TL</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Delocalised</td>
<td>OTOR</td>
<td>-</td>
<td>X</td>
<td>X</td>
<td>X</td>
</tr>
<tr class="even">
<td>Localised</td>
<td>GOT</td>
<td>X</td>
<td>-</td>
<td>X</td>
<td>X</td>
</tr>
<tr class="odd">
<td>Excited state tunnelling</td>
<td>LTM</td>
<td>X</td>
<td>-</td>
<td>X</td>
<td>X</td>
</tr>
</tbody>
</table>
<p>In the table above column headers refer to stimulation modes, which
are infrared stimulated luminescence (IRSL), optically stimulated
luminescence (OSL), LM-OSL <span class="citation">(Bulur 1996)</span>,
and thermally stimulated luminescence (short: TL). In the column `BASE
MODEL’ OTOR refers to `One Trap-One Recombination Centre’, GOT to
`General One Trap’, and LTM to `Localized Transition Model’ <span class="citation">(Jain et al. 2012; Pagonis et al. 2019)</span>. For
general overview we refer to the excellent book by <span class="citation">Chen and Pagonis (2011)</span>.</p>
</div>
<div class="section level3">
<h3 id="where-to-find-them">Where to find them<a class="anchor" aria-label="anchor" href="#where-to-find-them"></a>
</h3>
<p>The following table lists models as implemented in `RLumCarlo’ along
with the <strong>R</strong> function call and the corresponding R (*.R)
and C++ (*.cpp) files. The modelling takes place in the C++ functions
which are wrapped by the R functions with a similar name. If you,
however, want to cross-check the code, you should inspect files with the
ending <code>.cpp</code>.</p>
<table class="table table" style="font-size: 8px; margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;">
MODEL_NAME
</th>
<th style="text-align:left;">
R_CALL
</th>
<th style="text-align:left;">
CORRESPONDING_FILES
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;font-weight: bold;">
MC_CW_IRSL_LOC
</td>
<td style="text-align:left;">
run_MC_CW_IRSL_LOC()
</td>
<td style="text-align:left;">
R/run_MC_CW_IRSL_LOC.R src/MC_C_MC_CW_IRSL_LOC.cpp
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
MC_CW_IRSL_TUN
</td>
<td style="text-align:left;">
run_MC_CW_IRSL_TUN()
</td>
<td style="text-align:left;">
R/run_MC_CW_IRSL_TUN.R src/MC_C_MC_CW_IRSL_TUN.cpp
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
MC_CW_OSL_DELOC
</td>
<td style="text-align:left;">
run_MC_CW_OSL_DELOC()
</td>
<td style="text-align:left;">
R/run_MC_CW_OSL_DELOC.R src/MC_C_MC_CW_OSL_DELOC.cpp
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
MC_ISO_DELOC
</td>
<td style="text-align:left;">
run_MC_ISO_DELOC()
</td>
<td style="text-align:left;">
R/run_MC_ISO_DELOC.R src/MC_C_MC_ISO_DELOC.cpp
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
MC_ISO_LOC
</td>
<td style="text-align:left;">
run_MC_ISO_LOC()
</td>
<td style="text-align:left;">
R/run_MC_ISO_LOC.R src/MC_C_MC_ISO_LOC.cpp
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
MC_ISO_TUN
</td>
<td style="text-align:left;">
run_MC_ISO_TUN()
</td>
<td style="text-align:left;">
R/run_MC_ISO_TUN.R src/MC_C_MC_ISO_TUN.cpp
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
MC_LM_OSL_DELOC
</td>
<td style="text-align:left;">
run_MC_LM_OSL_DELOC()
</td>
<td style="text-align:left;">
R/run_MC_LM_OSL_DELOC.R src/MC_C_MC_LM_OSL_DELOC.cpp
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
MC_LM_OSL_LOC
</td>
<td style="text-align:left;">
run_MC_LM_OSL_LOC()
</td>
<td style="text-align:left;">
R/run_MC_LM_OSL_LOC.R src/MC_C_MC_LM_OSL_LOC.cpp
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
MC_LM_OSL_TUN
</td>
<td style="text-align:left;">
run_MC_LM_OSL_TUN()
</td>
<td style="text-align:left;">
R/run_MC_LM_OSL_TUN.R src/MC_C_MC_LM_OSL_TUN.cpp
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
MC_TL_DELOC
</td>
<td style="text-align:left;">
run_MC_TL_DELOC()
</td>
<td style="text-align:left;">
R/run_MC_TL_DELOC.R src/MC_C_MC_TL_DELOC.cpp
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
MC_TL_LOC
</td>
<td style="text-align:left;">
run_MC_TL_LOC()
</td>
<td style="text-align:left;">
R/run_MC_TL_LOC.R src/MC_C_MC_TL_LOC.cpp
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
MC_TL_TUN
</td>
<td style="text-align:left;">
run_MC_TL_TUN()
</td>
<td style="text-align:left;">
R/run_MC_TL_TUN.R src/MC_C_MC_TL_TUN.cpp
</td>
</tr>
</tbody>
</table>
<p>Each model is run by calling one of the <strong>R</strong> functions
starting with <code>run_</code>. Currently, three different model types
(TUN: tunnelling, LOC: localised transition, DELOC: delocalised
transition) are implemented for the stimulation types TL, IRSL, LM-OSL,
and ISO (isothermal). Please note that each model has different
parameters and requirements.</p>
</div>
</div>
<div class="section level2">
<h2 id="rlumcarlo-model-parameters-and-variables">`RLumCarlo’ model parameters and variables<a class="anchor" aria-label="anchor" href="#rlumcarlo-model-parameters-and-variables"></a>
</h2>
<p>The following table summarises the parameters used in the implemented
MC models along with their physical meaning, units and the range of
realistic values. This range represents just a rough guideline and might
be exceeded for particular cases.</p>
</div>
<div class="section level2">
<h2 id="examples">Examples<a class="anchor" aria-label="anchor" href="#examples"></a>
</h2>
<p>The following examples illustrate the capacity of `RLumCarlo’, by
using code-snippets deploying longer simulation times than allowed for
the standard package examples, which aim at a functionality test.</p>
<div class="section level3">
<h3 id="example-1-a-first-example">Example 1: A first example<a class="anchor" aria-label="anchor" href="#example-1-a-first-example"></a>
</h3>
<p>The first example is an iso-thermal decay curve using the tunnelling
model (other models work similarly). Returned are either the simulated
signal or the estimated remaining trapped charge carriers. The Function
<code><a href="../reference/plot_RLumCarlo.html">plot_RLumCarlo()</a></code> provides an easy way to visualise the
modelling results and is here called using the tee operator
<code>%T&gt;</code> from the package <code>magrittr</code> (which is
imported by `RLumCarlo’). Simulation results are stored in the object
<code>results</code> while, at the same time, piped to the function
<code><a href="../reference/plot_RLumCarlo.html">plot_RLumCarlo()</a></code> for the output visualisation.</p>
<div class="section level4">
<h4 id="model-the-signal">Model the signal<a class="anchor" aria-label="anchor" href="#model-the-signal"></a>
</h4>
<p>The most obvious modelling output is the luminescence signal itself,
our example below simulates an iso-thermal (ITL) signal for a
temperature (<code>T</code>) of 200 °C over 5,000 s using a tunnelling
transition model. Trap parameters are
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mo>=</mo><mn>1.2</mn></mrow><annotation encoding="application/x-tex">E = 1.2</annotation></semantics></math>
eV for the trap depth and a frequency factor of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>×</mo><msup><mn>10</mn><mn>10</mn></msup></mrow><annotation encoding="application/x-tex">1\times10^{10}</annotation></semantics></math>
(1/s). The parameter <code>rho</code>
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>ρ</mi><mo>′</mo></msup><annotation encoding="application/x-tex">\rho'</annotation></semantics></math>)
defines the recombination centre density.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_MC_ISO_TUN.html">run_MC_ISO_TUN</a></span><span class="op">(</span></span>
<span>  E <span class="op">=</span> <span class="fl">1.2</span>,</span>
<span>  s <span class="op">=</span> <span class="fl">1e10</span>,</span>
<span>  T <span class="op">=</span> <span class="fl">200</span>,</span>
<span>  N_e <span class="op">=</span> <span class="fl">200</span>,</span>
<span>  rho <span class="op">=</span> <span class="fl">0.007</span>,</span>
<span>  clusters <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  times <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">5000</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">%T&gt;%</span></span>
<span>  <span class="fu"><a href="../reference/plot_RLumCarlo.html">plot_RLumCarlo</a></span><span class="op">(</span>norm <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                 legend <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                 main <span class="op">=</span> <span class="st">"Iso-thermal decay (TUN)"</span><span class="op">)</span></span></code></pre></div>
<p><img src="RLumCarlo_-_Getting_started_with_RLumCarlo_files/figure-html/Fig%201-1.png" width="480" style="display: block; margin: auto;">
In the example above <code>N_e</code> is a scalar, which means that all
clusters start with the same number of electrons (here 200). However,
`RLumCarlo’ supports different starting conditions with regard to the
initial number of electrons. For example, one could assume that the
number of initial electrons vary randomly between 190 and 210. Such a
situation is created in the next example. Generally, `RLumCarlo’
supports such an input for the parameters <code>N_e</code> and
<code>n_filled</code>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_MC_ISO_TUN.html">run_MC_ISO_TUN</a></span><span class="op">(</span></span>
<span>  E <span class="op">=</span> <span class="fl">1.2</span>,</span>
<span>  s <span class="op">=</span> <span class="fl">1e10</span>,</span>
<span>  T <span class="op">=</span> <span class="fl">200</span>,</span>
<span>  N_e <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">190</span><span class="op">:</span><span class="fl">210</span>,<span class="fl">10</span>,<span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>  rho <span class="op">=</span> <span class="fl">0.007</span>,</span>
<span>  clusters <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  times <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">5000</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">%T&gt;%</span></span>
<span>  <span class="fu"><a href="../reference/plot_RLumCarlo.html">plot_RLumCarlo</a></span><span class="op">(</span>norm <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                 legend <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                 main <span class="op">=</span> <span class="st">"Iso-thermal decay (TUN) for varying N_e"</span><span class="op">)</span></span></code></pre></div>
<p><img src="RLumCarlo_-_Getting_started_with_RLumCarlo_files/figure-html/Fig%201b-1.png" width="480" style="display: block; margin: auto;"></p>
</div>
<div class="section level4">
<h4 id="model-remaining-charges">Model remaining charges<a class="anchor" aria-label="anchor" href="#model-remaining-charges"></a>
</h4>
<p>The first example can be slightly altered to provide alternative
insight. Instead of the luminescence signal, the variant below returns
the number of remaining electrons in the trap.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_MC_ISO_TUN.html">run_MC_ISO_TUN</a></span><span class="op">(</span></span>
<span>  E <span class="op">=</span> <span class="fl">1.2</span>,</span>
<span>  s <span class="op">=</span> <span class="fl">1e10</span>,</span>
<span>  T <span class="op">=</span> <span class="fl">200</span>,</span>
<span>  rho <span class="op">=</span> <span class="fl">0.007</span>,</span>
<span>  times <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">5000</span><span class="op">)</span>, </span>
<span>  output <span class="op">=</span> <span class="st">"remaining_e"</span></span>
<span><span class="op">)</span> <span class="op">%T&gt;%</span></span>
<span>  <span class="fu"><a href="../reference/plot_RLumCarlo.html">plot_RLumCarlo</a></span><span class="op">(</span></span>
<span>    legend <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    ylab <span class="op">=</span> <span class="st">"Remaining electrons"</span></span>
<span>    <span class="op">)</span></span></code></pre></div>
<p><img src="RLumCarlo_-_Getting_started_with_RLumCarlo_files/figure-html/Fig%202-1.png" width="480" style="display: block; margin: auto;"></p>
</div>
<div class="section level4">
<h4 id="understanding-the-numerical-output">Understanding the numerical output<a class="anchor" aria-label="anchor" href="#understanding-the-numerical-output"></a>
</h4>
<p>In both cases the modelling output is an object of class
<code>RLumCarlo_Model_Output</code>, which is basically a list
consisting of an <code>array</code> and a <code>numeric</code>
(vector).</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">results</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## List of 2</span></span>
<span><span class="co">##  $ signal: num [1:5001, 1:21, 1:10] 200 200 200 200 200 200 200 200 200 200 ...</span></span>
<span><span class="co">##   ..- attr(*, "dimnames")=List of 3</span></span>
<span><span class="co">##   .. ..$ : NULL</span></span>
<span><span class="co">##   .. ..$ : NULL</span></span>
<span><span class="co">##   .. ..$ : NULL</span></span>
<span><span class="co">##  $ time  : int [1:5001] 0 1 2 3 4 5 6 7 8 9 ...</span></span>
<span><span class="co">##  - attr(*, "class")= chr "RLumCarlo_Model_Output"</span></span>
<span><span class="co">##  - attr(*, "model")= chr "run_MC_ISO_TUN"</span></span></code></pre>
<p>While this represents the full modelling output results, its
interpretation might be less straight forward, and the user may want to
condense the information via <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code>. The function
<code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> is also used internally by the function
<code><a href="../reference/plot_RLumCarlo.html">plot_RLumCarlo()</a></code> to simplify the data before there are
plotted.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">results</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##       time           mean          y_min          y_max            sd       </span></span>
<span><span class="co">##  Min.   :   0   Min.   :3062   Min.   :3029   Min.   :3084   Min.   : 1.16  </span></span>
<span><span class="co">##  1st Qu.:1250   1st Qu.:3173   1st Qu.:3148   1st Qu.:3202   1st Qu.:12.46  </span></span>
<span><span class="co">##  Median :2500   Median :3331   Median :3312   Median :3358   Median :15.69  </span></span>
<span><span class="co">##  Mean   :2500   Mean   :3414   Mean   :3392   Mean   :3438   Mean   :15.03  </span></span>
<span><span class="co">##  3rd Qu.:3750   3rd Qu.:3591   3rd Qu.:3573   3rd Qu.:3628   3rd Qu.:17.81  </span></span>
<span><span class="co">##  Max.   :5000   Max.   :4199   Max.   :4197   Max.   :4200   Max.   :20.69  </span></span>
<span><span class="co">##       var               sum       </span></span>
<span><span class="co">##  Min.   :  1.344   Min.   :30616  </span></span>
<span><span class="co">##  1st Qu.:155.156   1st Qu.:31733  </span></span>
<span><span class="co">##  Median :246.233   Median :33308  </span></span>
<span><span class="co">##  Mean   :237.984   Mean   :34140  </span></span>
<span><span class="co">##  3rd Qu.:317.067   3rd Qu.:35906  </span></span>
<span><span class="co">##  Max.   :428.100   Max.   :41987</span></span></code></pre>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   time   mean y_min y_max       sd      var   sum</span></span>
<span><span class="co">## 1    0 4198.7  4197  4200 1.159502 1.344444 41987</span></span>
<span><span class="co">## 2    1 4198.2  4196  4200 1.549193 2.400000 41982</span></span>
<span><span class="co">## 3    2 4196.9  4194  4200 2.131770 4.544444 41969</span></span>
<span><span class="co">## 4    3 4196.6  4194  4200 2.118700 4.488889 41966</span></span>
<span><span class="co">## 5    4 4195.9  4193  4200 2.514403 6.322222 41959</span></span>
<span><span class="co">## 6    5 4195.1  4191  4200 2.514403 6.322222 41951</span></span></code></pre>
<p>The call summarises the modelling results and returns a terminal
output and a <code>data.frame</code> with, e.g., the mean or the
standard deviation, which can be used to create plots for further
insight. For instance, the stimulation time against coefficient of
variation (CV in %):</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">time</span>,</span>
<span>  y <span class="op">=</span> <span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">sd</span> <span class="op">/</span> <span class="va">df</span><span class="op">$</span><span class="va">mean</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span>,</span>
<span>  pch <span class="op">=</span> <span class="fl">20</span>, </span>
<span>  col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html" class="external-link">rgb</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">.1</span><span class="op">)</span>,</span>
<span>  xlab <span class="op">=</span> <span class="st">"Stimulation time [s]"</span>,</span>
<span>  ylab <span class="op">=</span> <span class="st">"CV [%]"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="RLumCarlo_-_Getting_started_with_RLumCarlo_files/figure-html/Fig%203-1.png" width="480" style="display: block; margin: auto;"></p>
</div>
</div>
<div class="section level3">
<h3 id="example-2-combining-two-plots">Example 2: Combining two plots<a class="anchor" aria-label="anchor" href="#example-2-combining-two-plots"></a>
</h3>
<p>The following examples use again the tunnelling model but for
continuous wave (CW) infrared light stimulation (IRSL), and they combine
two plots in one single plot window.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## set time vector </span></span>
<span><span class="va">times</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1000</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Run MC simulation</span></span>
<span><span class="fu"><a href="../reference/run_MC_CW_IRSL_TUN.html">run_MC_CW_IRSL_TUN</a></span><span class="op">(</span>A <span class="op">=</span> <span class="fl">0.12</span>, rho <span class="op">=</span> <span class="fl">0.003</span>, times <span class="op">=</span> <span class="va">times</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="../reference/plot_RLumCarlo.html">plot_RLumCarlo</a></span><span class="op">(</span>norm <span class="op">=</span> <span class="cn">TRUE</span>, legend <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/run_MC_CW_IRSL_TUN.html">run_MC_CW_IRSL_TUN</a></span><span class="op">(</span>A <span class="op">=</span> <span class="fl">0.21</span>, rho <span class="op">=</span> <span class="fl">0.003</span>, times <span class="op">=</span> <span class="va">times</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="../reference/plot_RLumCarlo.html">plot_RLumCarlo</a></span><span class="op">(</span>norm <span class="op">=</span> <span class="cn">TRUE</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="RLumCarlo_-_Getting_started_with_RLumCarlo_files/figure-html/Fig%204-1.png" width="480" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="example-3-testing-different-parameters">Example 3: Testing different parameters<a class="anchor" aria-label="anchor" href="#example-3-testing-different-parameters"></a>
</h3>
<p>The example above can be further extended to test the effect of
different parameters. Contrary to the example above, here the results
are stored in a <code>list</code> and <code><a href="../reference/plot_RLumCarlo.html">plot_RLumCarlo()</a></code> is
called only one time and it will then iterate automatically over the
results to create a combined plot.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">s</span> <span class="op">&lt;-</span> <span class="fl">3.5e12</span></span>
<span><span class="va">rho</span> <span class="op">&lt;-</span> <span class="fl">0.015</span></span>
<span><span class="va">E</span> <span class="op">&lt;-</span> <span class="fl">1.45</span></span>
<span><span class="va">r_c</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.7</span>,<span class="fl">0.77</span>,<span class="fl">0.86</span>, <span class="fl">0.97</span><span class="op">)</span></span>
<span><span class="va">times</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">450</span><span class="op">)</span> <span class="co"># here time = temperature</span></span>
<span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">r_c</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/run_MC_TL_TUN.html">run_MC_TL_TUN</a></span><span class="op">(</span></span>
<span>    s <span class="op">=</span> <span class="va">s</span>,</span>
<span>    E <span class="op">=</span> <span class="va">E</span>,</span>
<span>    rho <span class="op">=</span> <span class="va">rho</span>,</span>
<span>    r_c <span class="op">=</span> <span class="va">x</span>,</span>
<span>    times <span class="op">=</span> <span class="va">times</span></span>
<span>  <span class="op">)</span></span>
<span>  </span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
<p>The plot output can be highly customised to provide a better visual
experience, e.g., the manual setting of the colours and the legend.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## plot curves, but without legend</span></span>
<span><span class="fu"><a href="../reference/plot_RLumCarlo.html">plot_RLumCarlo</a></span><span class="op">(</span></span>
<span>  object <span class="op">=</span> <span class="va">results</span>, </span>
<span>  ylab <span class="op">=</span> <span class="st">"normalised TL signal"</span>,</span>
<span>  xlab <span class="op">=</span> <span class="st">"Temperature [\u00b0C]"</span>, </span>
<span>  plot_uncertainty <span class="op">=</span> <span class="st">"range"</span>,</span>
<span>  col <span class="op">=</span> <span class="fu">khroma</span><span class="fu">::</span><span class="fu"><a href="https://packages.tesselle.org/khroma/reference/colour.html" class="external-link">colour</a></span><span class="op">(</span><span class="st">"bright"</span><span class="op">)</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">r_c</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  legend <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  norm <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">## add legend manually</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span></span>
<span>  <span class="st">"topleft"</span>,</span>
<span>  bty <span class="op">=</span> <span class="st">"n"</span>,</span>
<span>  legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"r_c: "</span>, <span class="va">r_c</span><span class="op">)</span>,</span>
<span>  lty <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  col <span class="op">=</span> <span class="fu">khroma</span><span class="fu">::</span><span class="fu"><a href="https://packages.tesselle.org/khroma/reference/colour.html" class="external-link">colour</a></span><span class="op">(</span><span class="st">"bright"</span><span class="op">)</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">r_c</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="RLumCarlo_-_Getting_started_with_RLumCarlo_files/figure-html/Fig%206,Plot%20average%20signal-1.png" width="480" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="example-4-dosimetric-cluster-systems">Example 4: Dosimetric cluster systems<a class="anchor" aria-label="anchor" href="#example-4-dosimetric-cluster-systems"></a>
</h3>
<p>`RLumCarlo’ supports the simulation of a cheap dosimetric cluster
system with spatial correlation. Such a dosimetric cluster system can be
created with the function <code><a href="../reference/create_ClusterSystem.html">create_ClusterSystem()</a></code>:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">clusters</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_ClusterSystem.html">create_ClusterSystem</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">100</span>, plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="RLumCarlo_-_Getting_started_with_RLumCarlo_files/figure-html/unnamed-chunk-6-1.png" width="432" style="display: block; margin: auto;">
The result is an arbitrary dosimetric system with randomly distributed
clusters. The Euclidean distance is used to group the clusters (colour
code). To use the system in the simulation, instead of providing a
scalar as input to <code>clusters</code>, the output of
<code><a href="../reference/create_ClusterSystem.html">create_ClusterSystem()</a></code> can be injected in every
<code>run_MC</code> function.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/run_MC_TL_LOC.html">run_MC_TL_LOC</a></span><span class="op">(</span></span>
<span> s <span class="op">=</span> <span class="fl">1e14</span>,</span>
<span> E <span class="op">=</span> <span class="fl">0.9</span>,</span>
<span> times <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">100</span>,</span>
<span> b <span class="op">=</span> <span class="fl">1</span>,</span>
<span> n_filled <span class="op">=</span> <span class="fl">1000</span>,</span>
<span> method <span class="op">=</span> <span class="st">"seq"</span>,</span>
<span> clusters <span class="op">=</span> <span class="va">clusters</span>,</span>
<span> r <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span><span class="fu"><a href="../reference/plot_RLumCarlo.html">plot_RLumCarlo</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="RLumCarlo_-_Getting_started_with_RLumCarlo_files/figure-html/unnamed-chunk-7-1.png" width="480" style="display: block; margin: auto;"></p>
<p>Please note: For the simulation of a dosimetric cluster system, the
meaning of <code>n_filled</code> changes. Instead of defining the number
of electrons per cluster, it becomes the total number of electrons in
the system. Electrons are distributed according to the grouping of the
single clusters (the colours in the three-dimensional scatter plot).
Within one group, electrons are distributed evenly.</p>
</div>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Bulur_1996rc" class="csl-entry">
Bulur, Enver. 1996. <span>“<span>An Alternative Technique For Optically
Stimulated Luminescence (OSL) Experiment</span>.”</span> <em>Radiation
Measurements</em> 26 (5): 701–9. <a href="https://doi.org/10.1016/S1350-4487(97)82884-3" class="external-link">https://doi.org/10.1016/S1350-4487(97)82884-3</a>.
</div>
<div id="ref-Chen_2011vn" class="csl-entry">
Chen, R, and Vasilis Pagonis. 2011. <em><span class="nocase">Thermally
and Optically Stimulated Luminescence - A Simulation
Approach</span></em>. Thermally and Optically Stimulated Luminescence a
Simulation Approach. John Wiley <span>&amp;</span> Sons, Ltd.
</div>
<div id="ref-Jain:2012ic" class="csl-entry">
Jain, Mayank, Benny Guralnik, and Martin Thalbitzer Andersen. 2012.
<span>“<span class="nocase">Stimulated luminescence emission from
localized recombination in randomly distributed defects</span>.”</span>
<em>Journal of Physics: Condensed Matter</em> 24 (38): 385402. <a href="https://doi.org/10.1088/0953-8984/24/38/385402" class="external-link">https://doi.org/10.1088/0953-8984/24/38/385402</a>.
</div>
<div id="ref-Pagonis:2019hk" class="csl-entry">
Pagonis, Vasilis, Johannes Friedrich, Michael Discher, et al. 2019.
<span>“<span class="nocase">Excited state luminescence signals from a
random distribution of defects_ A new Monte Carlo simulation approach
for feldspar</span>.”</span> <em>Journal of Luminescence</em> 207:
266–72. <a href="https://doi.org/10.1016/j.jlumin.2018.11.024" class="external-link">https://doi.org/10.1016/j.jlumin.2018.11.024</a>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Johannes Friedrich, Sebastian Kreutzer, Vasilis Pagonis, Christoph Schmidt.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
