<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>`RLumCarlo': Tedious features - fine examples • RLumCarlo</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="`RLumCarlo': Tedious features - fine examples">
<meta property="og:description" content="RLumCarlo">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">RLumCarlo</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.6</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/RLumCarlo_-_Getting_started_with_RLumCarlo.html">`RLumCarlo': Tedious features - fine examples</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/R-Lum/RLumCarlo/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="RLumCarlo_-_Getting_started_with_RLumCarlo_files/header-attrs-2.5/header-attrs.js"></script><link href="RLumCarlo_-_Getting_started_with_RLumCarlo_files/anchor-sections-1.0/anchor-sections.css" rel="stylesheet">
<script src="RLumCarlo_-_Getting_started_with_RLumCarlo_files/anchor-sections-1.0/anchor-sections.js"></script><script src="RLumCarlo_-_Getting_started_with_RLumCarlo_files/kePrint-0.0.1/kePrint.js"></script><link href="RLumCarlo_-_Getting_started_with_RLumCarlo_files/lightable-0.0.1/lightable.css" rel="stylesheet">
<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>`RLumCarlo’: Tedious features - fine examples</h1>
                        <h4 class="author">Sebastian Kreutzer, Johannes Friedrich, Vasilis Pagonis, Christoph Schmidt</h4>
            
            <h4 class="date">RLumCarlo: v0.1.7.9000.5 | last modified: 2020-11-03</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/R-Lum/RLumCarlo/blob/master/vignettes/RLumCarlo_-_Getting_started_with_RLumCarlo.Rmd"><code>vignettes/RLumCarlo_-_Getting_started_with_RLumCarlo.Rmd</code></a></small>
      <div class="hidden name"><code>RLumCarlo_-_Getting_started_with_RLumCarlo.Rmd</code></div>

    </div>

    
    
<p><img src="../man/figures/Logo_RLumCarlo.png" width="150" style="display: block; margin: auto;"></p>
<div id="scope" class="section level1">
<h1 class="hasAnchor">
<a href="#scope" class="anchor"></a>Scope</h1>
<p>`RLumCarlo’ is a collection of energy-band models to simulate luminescence signals in dosimetric materials using Monte-Carlo (MC) methods for various stimulation modes. This document aims at supplementing the package documentation and elaborating the package examples.</p>
</div>
<div id="the-models-in-rlumcarlo" class="section level1">
<h1 class="hasAnchor">
<a href="#the-models-in-rlumcarlo" class="anchor"></a>The models in `RLumCarlo’</h1>
<div id="overview" class="section level2">
<h2 class="hasAnchor">
<a href="#overview" class="anchor"></a>Overview</h2>
<table class="table">
<thead><tr class="header">
<th>TRANSITION</th>
<th>BASE MODEL</th>
<th>IRSL</th>
<th>OSL</th>
<th>LM-OSL</th>
<th>TL</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Delocalised</td>
<td>OTOR</td>
<td>-</td>
<td>X</td>
<td>X</td>
<td>X</td>
</tr>
<tr class="even">
<td>Localised</td>
<td>GOT</td>
<td>X</td>
<td>-</td>
<td>X</td>
<td>X</td>
</tr>
<tr class="odd">
<td>Excited state tunnelling</td>
<td>LTM</td>
<td>X</td>
<td>-</td>
<td>X</td>
<td>X</td>
</tr>
</tbody>
</table>
<p>In the table above column headers refer to stimulation modes, which are infrared stimulated luminescence (IRSL), optically stimulated luminescence (OSL), LM-OSL <span class="citation">(Bulur 1996)</span>, and thermally stimulated luminescence (short: TL). In the column `BASE MODEL’ OTOR refers to `One Trap-One Recombination Centre’, GOT to `General One Trap’, and LTM to `Localized Transition Model’ <span class="citation">(Jain, Guralnik, and Andersen 2012; Pagonis et al. 2019)</span>. For general overview we refer to the excellent book by <span class="citation">Chen and Pagonis (2011)</span>.</p>
</div>
<div id="where-to-find-them" class="section level2">
<h2 class="hasAnchor">
<a href="#where-to-find-them" class="anchor"></a>Where to find them</h2>
<p>The following table lists models as implemented in `RLumCarlo’ along with the <strong>R</strong> function call and the corresponding R (*.R) and C++ (*.cpp) files. The modelling takes place in the C++ functions which are wrapped by the R functions with a similar name. If you, however, want to cross-check the code, you should inspect files with the ending <code>.cpp</code>.</p>
<table class="table table">
<thead><tr>
<th style="text-align:left;">
MODEL_NAME
</th>
<th style="text-align:left;">
R_CALL
</th>
<th style="text-align:left;">
CORRESPONDING_FILES
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;font-weight: bold;">
MC_CW_IRSL_LOC
</td>
<td style="text-align:left;">
run_MC_CW_IRSL_LOC()
</td>
<td style="text-align:left;">
R/run_MC_CW_IRSL_LOC.R src/MC_C_MC_CW_IRSL_LOC.cpp
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
MC_CW_IRSL_TUN
</td>
<td style="text-align:left;">
run_MC_CW_IRSL_TUN()
</td>
<td style="text-align:left;">
R/run_MC_CW_IRSL_TUN.R src/MC_C_MC_CW_IRSL_TUN.cpp
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
MC_CW_OSL_DELOC
</td>
<td style="text-align:left;">
run_MC_CW_OSL_DELOC()
</td>
<td style="text-align:left;">
R/run_MC_CW_OSL_DELOC.R src/MC_C_MC_CW_OSL_DELOC.cpp
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
MC_ISO_DELOC
</td>
<td style="text-align:left;">
run_MC_ISO_DELOC()
</td>
<td style="text-align:left;">
R/run_MC_ISO_DELOC.R src/MC_C_MC_ISO_DELOC.cpp
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
MC_ISO_LOC
</td>
<td style="text-align:left;">
run_MC_ISO_LOC()
</td>
<td style="text-align:left;">
R/run_MC_ISO_LOC.R src/MC_C_MC_ISO_LOC.cpp
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
MC_ISO_TUN
</td>
<td style="text-align:left;">
run_MC_ISO_TUN()
</td>
<td style="text-align:left;">
R/run_MC_ISO_TUN.R src/MC_C_MC_ISO_TUN.cpp
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
MC_LM_OSL_DELOC
</td>
<td style="text-align:left;">
run_MC_LM_OSL_DELOC()
</td>
<td style="text-align:left;">
R/run_MC_LM_OSL_DELOC.R src/MC_C_MC_LM_OSL_DELOC.cpp
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
MC_LM_OSL_LOC
</td>
<td style="text-align:left;">
run_MC_LM_OSL_LOC()
</td>
<td style="text-align:left;">
R/run_MC_LM_OSL_LOC.R src/MC_C_MC_LM_OSL_LOC.cpp
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
MC_LM_OSL_TUN
</td>
<td style="text-align:left;">
run_MC_LM_OSL_TUN()
</td>
<td style="text-align:left;">
R/run_MC_LM_OSL_TUN.R src/MC_C_MC_LM_OSL_TUN.cpp
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
MC_TL_DELOC
</td>
<td style="text-align:left;">
run_MC_TL_DELOC()
</td>
<td style="text-align:left;">
R/run_MC_TL_DELOC.R src/MC_C_MC_TL_DELOC.cpp
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
MC_TL_LOC
</td>
<td style="text-align:left;">
run_MC_TL_LOC()
</td>
<td style="text-align:left;">
R/run_MC_TL_LOC.R src/MC_C_MC_TL_LOC.cpp
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
MC_TL_TUN
</td>
<td style="text-align:left;">
run_MC_TL_TUN()
</td>
<td style="text-align:left;">
R/run_MC_TL_TUN.R src/MC_C_MC_TL_TUN.cpp
</td>
</tr>
</tbody>
</table>
<p>Each model is run by calling one of the <strong>R</strong> functions starting with <code>run_</code>. Currently, three different model types (TUN: tunnelling, LOC: localised transition, DELOC: delocalised transition) are implemented for the stimulation types TL, IRSL, LM-OSL, and ISO (isothermal). Please note that each model has different parameters and requirements.</p>
</div>
</div>
<div id="rlumcarlo-model-parameters-and-variables" class="section level1">
<h1 class="hasAnchor">
<a href="#rlumcarlo-model-parameters-and-variables" class="anchor"></a>`RLumCarlo’ model parameters and variables</h1>
<p>The following table summarises the parameters used in the implemented MC models along with their physical meaning, units and the range of realistic values. This range represents just a rough guideline and might be exceeded for particular cases.</p>
</div>
<div id="examples" class="section level1">
<h1 class="hasAnchor">
<a href="#examples" class="anchor"></a>Examples</h1>
<p>The following examples illustrate the capacity of `RLumCarlo’, by using code-snippets deploying longer simulation times than allowed for the standard package examples, which aim at a functionality test.</p>
<div id="example-1-a-first-example" class="section level2">
<h2 class="hasAnchor">
<a href="#example-1-a-first-example" class="anchor"></a>Example 1: A first example</h2>
<p>The first example is an iso-thermal decay curve using the tunnelling model (other models work similarly). Returned are either the simulated signal or the estimated remaining trapped charge carriers. The Function <code><a href="../reference/plot_RLumCarlo.html">plot_RLumCarlo()</a></code> provides an easy way to visualise the modelling results and is here called using the tee operator <code>%T&gt;</code> from the package <code>magrittr</code> (which is imported by `RLumCarlo’). Simulation results are stored in the object <code>results</code> while, at the same time, piped to the function <code><a href="../reference/plot_RLumCarlo.html">plot_RLumCarlo()</a></code> for the output visualisation.</p>
<div id="model-the-signal" class="section level3">
<h3 class="hasAnchor">
<a href="#model-the-signal" class="anchor"></a>Model the signal</h3>
<p>The most obvious modelling output is the luminescence signal itself, our example below simulates an iso-thermal (ITL) signal for a temperature (<code>T</code>) of 200 °C over 5,000 s using a tunnelling transition model. Trap parameters are <span class="math inline">\(E = 1.2\)</span> eV for the trap depth and a frequency factor of <span class="math inline">\(1\times10^{10}\)</span> (1/s). The parameter <code>rho</code> (<span class="math inline">\(\rho'\)</span>) defines the recombination centre density.</p>
<div class="sourceCode" id="cb1"><pre class="downlit">
<span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_MC_ISO_TUN.html">run_MC_ISO_TUN</a></span><span class="op">(</span>
  E <span class="op">=</span> <span class="fl">1.2</span>,
  s <span class="op">=</span> <span class="fl">1e10</span>,
  T <span class="op">=</span> <span class="fl">200</span>,
  N_e <span class="op">=</span> <span class="fl">200</span>,
  rho <span class="op">=</span> <span class="fl">0.007</span>,
  clusters <span class="op">=</span> <span class="fl">10</span>,
  times <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">5000</span><span class="op">)</span>
<span class="op">)</span> <span class="op">%T&gt;%</span>
  <span class="fu"><a href="../reference/plot_RLumCarlo.html">plot_RLumCarlo</a></span><span class="op">(</span>norm <span class="op">=</span> <span class="cn">TRUE</span>,
                 legend <span class="op">=</span> <span class="cn">TRUE</span>,
                 main <span class="op">=</span> <span class="st">"Iso-thermal decay (TUN)"</span><span class="op">)</span></pre></div>
<p><img src="RLumCarlo_-_Getting_started_with_RLumCarlo_files/figure-html/Fig%201-1.png" width="480" style="display: block; margin: auto;"> In the example above <code>N_e</code> is a scalar, which means that all clusters start with the same number of electrons (here 200). However, `RLumCarlo’ supports different starting conditions with regard to the initial number of electrons. For example, one could assume that the number of initial electrons vary randomly between 190 and 210. Such a situation is created in the next example. Generally, `RLumCarlo’ supports such an input for the parameters <code>N_e</code> and <code>n_filled</code>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit">
<span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_MC_ISO_TUN.html">run_MC_ISO_TUN</a></span><span class="op">(</span>
  E <span class="op">=</span> <span class="fl">1.2</span>,
  s <span class="op">=</span> <span class="fl">1e10</span>,
  T <span class="op">=</span> <span class="fl">200</span>,
  N_e <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">190</span><span class="op">:</span><span class="fl">210</span>,<span class="fl">10</span>,<span class="cn">TRUE</span><span class="op">)</span>,
  rho <span class="op">=</span> <span class="fl">0.007</span>,
  clusters <span class="op">=</span> <span class="fl">10</span>,
  times <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">5000</span><span class="op">)</span>
<span class="op">)</span> <span class="op">%T&gt;%</span>
  <span class="fu"><a href="../reference/plot_RLumCarlo.html">plot_RLumCarlo</a></span><span class="op">(</span>norm <span class="op">=</span> <span class="cn">TRUE</span>,
                 legend <span class="op">=</span> <span class="cn">TRUE</span>,
                 main <span class="op">=</span> <span class="st">"Iso-thermal decay (TUN) for varying N_e"</span><span class="op">)</span></pre></div>
<p><img src="RLumCarlo_-_Getting_started_with_RLumCarlo_files/figure-html/Fig%201b-1.png" width="480" style="display: block; margin: auto;"></p>
</div>
<div id="model-remaining-charges" class="section level3">
<h3 class="hasAnchor">
<a href="#model-remaining-charges" class="anchor"></a>Model remaining charges</h3>
<p>The first example can be slightly altered to provide alternative insight. Instead of the luminescence signal, the variant below returns the number of remaining electrons in the trap.</p>
<div class="sourceCode" id="cb3"><pre class="downlit">
<span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_MC_ISO_TUN.html">run_MC_ISO_TUN</a></span><span class="op">(</span>
  E <span class="op">=</span> <span class="fl">1.2</span>,
  s <span class="op">=</span> <span class="fl">1e10</span>,
  T <span class="op">=</span> <span class="fl">200</span>,
  rho <span class="op">=</span> <span class="fl">0.007</span>,
  times <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">5000</span><span class="op">)</span>, 
  output <span class="op">=</span> <span class="st">"remaining_e"</span>
<span class="op">)</span> <span class="op">%T&gt;%</span>
  <span class="fu"><a href="../reference/plot_RLumCarlo.html">plot_RLumCarlo</a></span><span class="op">(</span>
    legend <span class="op">=</span> <span class="cn">TRUE</span>,
    ylab <span class="op">=</span> <span class="st">"Remaining electrons"</span>
    <span class="op">)</span></pre></div>
<p><img src="RLumCarlo_-_Getting_started_with_RLumCarlo_files/figure-html/Fig%202-1.png" width="480" style="display: block; margin: auto;"></p>
</div>
<div id="understanding-the-numerical-output" class="section level3">
<h3 class="hasAnchor">
<a href="#understanding-the-numerical-output" class="anchor"></a>Understanding the numerical output</h3>
<p>In both cases the modelling output is an object of class <code>RLumCarlo_Model_Output</code>, which is basically a list consisting of an <code>array</code> and a <code>numeric</code> (vector).</p>
<div class="sourceCode" id="cb4"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">results</span><span class="op">)</span></pre></div>
<pre><code>## List of 2
##  $ signal: num [1:5001, 1:21, 1:10] 200 200 200 200 200 200 200 200 200 200 ...
##   ..- attr(*, "dimnames")=List of 3
##   .. ..$ : NULL
##   .. ..$ : NULL
##   .. ..$ : NULL
##  $ time  : int [1:5001] 0 1 2 3 4 5 6 7 8 9 ...
##  - attr(*, "class")= chr "RLumCarlo_Model_Output"
##  - attr(*, "model")= chr "run_MC_ISO_TUN"</code></pre>
<p>While this represents the full modelling output results, its interpretation might be less straight forward, and the user may want to condense the information via <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code>. The function <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code> is also used internally by the function <code><a href="../reference/plot_RLumCarlo.html">plot_RLumCarlo()</a></code> to simplify the data before there are plotted.</p>
<div class="sourceCode" id="cb6"><pre class="downlit">
<span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">results</span><span class="op">)</span></pre></div>
<pre><code>##       time           mean          y_min          y_max            sd        
##  Min.   :   0   Min.   :3074   Min.   :3056   Min.   :3094   Min.   : 1.059  
##  1st Qu.:1250   1st Qu.:3181   1st Qu.:3150   1st Qu.:3202   1st Qu.:12.237  
##  Median :2500   Median :3342   Median :3326   Median :3372   Median :13.343  
##  Mean   :2500   Mean   :3422   Mean   :3400   Mean   :3445   Mean   :13.142  
##  3rd Qu.:3750   3rd Qu.:3598   3rd Qu.:3582   3rd Qu.:3623   3rd Qu.:14.283  
##  Max.   :5000   Max.   :4199   Max.   :4197   Max.   :4200   Max.   :17.128  
##       var               sum       
##  Min.   :  1.122   Min.   :30740  
##  1st Qu.:149.733   1st Qu.:31813  
##  Median :178.044   Median :33421  
##  Mean   :176.180   Mean   :34216  
##  3rd Qu.:204.011   3rd Qu.:35984  
##  Max.   :293.378   Max.   :41993</code></pre>
<div class="sourceCode" id="cb8"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></pre></div>
<pre><code>##   time   mean y_min y_max       sd       var   sum
## 1    0 4199.3  4197  4200 1.059350  1.122222 41993
## 2    1 4198.6  4195  4200 1.429841  2.044444 41986
## 3    2 4198.1  4194  4200 1.852926  3.433333 41981
## 4    3 4197.1  4193  4199 1.969207  3.877778 41971
## 5    4 4196.4  4191  4199 2.796824  7.822222 41964
## 6    5 4195.7  4190  4199 3.198958 10.233333 41957</code></pre>
<p>The call summarises the modelling results and returns a terminal output and a <code>data.frame</code> with, e.g., the mean or the standard deviation, which can be used to create plots for further insight. For instance, the stimulation time against coefficient of variation (CV in %):</p>
<div class="sourceCode" id="cb10"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span>
  x <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">time</span>,
  y <span class="op">=</span> <span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">sd</span> <span class="op">/</span> <span class="va">df</span><span class="op">$</span><span class="va">mean</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span>,
  pch <span class="op">=</span> <span class="fl">20</span>, 
  col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">.1</span><span class="op">)</span>,
  xlab <span class="op">=</span> <span class="st">"Stimulation time [s]"</span>,
  ylab <span class="op">=</span> <span class="st">"CV [%]"</span>
<span class="op">)</span></pre></div>
<p><img src="RLumCarlo_-_Getting_started_with_RLumCarlo_files/figure-html/Fig%203-1.png" width="480" style="display: block; margin: auto;"></p>
</div>
</div>
<div id="example-2-combining-two-plots" class="section level2">
<h2 class="hasAnchor">
<a href="#example-2-combining-two-plots" class="anchor"></a>Example 2: Combining two plots</h2>
<p>The following examples use again the tunnelling model but for continuous wave (CW) infrared light stimulation (IRSL), and they combine two plots in one single plot window.</p>
<div class="sourceCode" id="cb11"><pre class="downlit">
<span class="co">## set time vector </span>
<span class="va">times</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1000</span><span class="op">)</span>

<span class="co">## Run MC simulation</span>
<span class="fu"><a href="../reference/run_MC_CW_IRSL_TUN.html">run_MC_CW_IRSL_TUN</a></span><span class="op">(</span>A <span class="op">=</span> <span class="fl">0.12</span>, rho <span class="op">=</span> <span class="fl">0.003</span>, times <span class="op">=</span> <span class="va">times</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/plot_RLumCarlo.html">plot_RLumCarlo</a></span><span class="op">(</span>norm <span class="op">=</span> <span class="cn">TRUE</span>, legend <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="fu"><a href="../reference/run_MC_CW_IRSL_TUN.html">run_MC_CW_IRSL_TUN</a></span><span class="op">(</span>A <span class="op">=</span> <span class="fl">0.21</span>, rho <span class="op">=</span> <span class="fl">0.003</span>, times <span class="op">=</span> <span class="va">times</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/plot_RLumCarlo.html">plot_RLumCarlo</a></span><span class="op">(</span>norm <span class="op">=</span> <span class="cn">TRUE</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></pre></div>
<p><img src="RLumCarlo_-_Getting_started_with_RLumCarlo_files/figure-html/Fig%204-1.png" width="480" style="display: block; margin: auto;"></p>
</div>
<div id="example-3-testing-different-parameters" class="section level2">
<h2 class="hasAnchor">
<a href="#example-3-testing-different-parameters" class="anchor"></a>Example 3: Testing different parameters</h2>
<p>The example above can be further extended to test the effect of different parameters. Contrary to the example above, here the results are stored in a <code>list</code> and <code><a href="../reference/plot_RLumCarlo.html">plot_RLumCarlo()</a></code> is called only one time and it will then iterate automatically over the results to create a combined plot.</p>
<div class="sourceCode" id="cb12"><pre class="downlit">
<span class="va">s</span> <span class="op">&lt;-</span> <span class="fl">3.5e12</span>
<span class="va">rho</span> <span class="op">&lt;-</span> <span class="fl">0.015</span>
<span class="va">E</span> <span class="op">&lt;-</span> <span class="fl">1.45</span>
<span class="va">r_c</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.7</span>,<span class="fl">0.77</span>,<span class="fl">0.86</span>, <span class="fl">0.97</span><span class="op">)</span>
<span class="va">times</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">450</span><span class="op">)</span> <span class="co"># here time = temperature</span>
<span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">r_c</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="../reference/run_MC_TL_TUN.html">run_MC_TL_TUN</a></span><span class="op">(</span>
    s <span class="op">=</span> <span class="va">s</span>,
    E <span class="op">=</span> <span class="va">E</span>,
    rho <span class="op">=</span> <span class="va">rho</span>,
    r_c <span class="op">=</span> <span class="va">x</span>,
    times <span class="op">=</span> <span class="va">times</span>
  <span class="op">)</span>
  
<span class="op">}</span><span class="op">)</span></pre></div>
<p>The plot output can be highly customised to provide a better visual experience, e.g., the manual setting of the colours and the legend.</p>
<div class="sourceCode" id="cb13"><pre class="downlit">
<span class="co">## plot curves, but without legend</span>
<span class="fu"><a href="../reference/plot_RLumCarlo.html">plot_RLumCarlo</a></span><span class="op">(</span>
  object <span class="op">=</span> <span class="va">results</span>, 
  ylab <span class="op">=</span> <span class="st">"normalised TL signal"</span>,
  xlab <span class="op">=</span> <span class="st">"Temperature [\u00b0C]"</span>, 
  plot_uncertainty <span class="op">=</span> <span class="st">"range"</span>,
  col <span class="op">=</span> <span class="fu">khroma</span><span class="fu">::</span><span class="fu"><a href="http://khroma.archaeo.science/reference/colour.html">colour</a></span><span class="op">(</span><span class="st">"bright"</span><span class="op">)</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">r_c</span><span class="op">)</span><span class="op">)</span>,
  legend <span class="op">=</span> <span class="cn">FALSE</span>,
  norm <span class="op">=</span> <span class="cn">TRUE</span>
<span class="op">)</span>

<span class="co">## add legend manually</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span><span class="op">(</span>
  <span class="st">"topleft"</span>,
  bty <span class="op">=</span> <span class="st">"n"</span>,
  legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"r_c: "</span>, <span class="va">r_c</span><span class="op">)</span>,
  lty <span class="op">=</span> <span class="fl">1</span>,
  col <span class="op">=</span> <span class="fu">khroma</span><span class="fu">::</span><span class="fu"><a href="http://khroma.archaeo.science/reference/colour.html">colour</a></span><span class="op">(</span><span class="st">"bright"</span><span class="op">)</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">r_c</span><span class="op">)</span><span class="op">)</span>
<span class="op">)</span></pre></div>
<p><img src="RLumCarlo_-_Getting_started_with_RLumCarlo_files/figure-html/Fig%206,Plot%20average%20signal-1.png" width="480" style="display: block; margin: auto;"></p>
</div>
<div id="example-4-dosimetric-cluster-systems" class="section level2">
<h2 class="hasAnchor">
<a href="#example-4-dosimetric-cluster-systems" class="anchor"></a>Example 4: Dosimetric cluster systems</h2>
<p>`RLumCarlo’ supports the simulation of a cheap dosimetric cluster system with spatial correlation. Such a dosimetric cluster system can be created with the function <code><a href="../reference/create_ClusterSystem.html">create_ClusterSystem()</a></code>:</p>
<div class="sourceCode" id="cb14"><pre class="downlit">
<span class="va">clusters</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_ClusterSystem.html">create_ClusterSystem</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">100</span>, plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></pre></div>
<p><img src="RLumCarlo_-_Getting_started_with_RLumCarlo_files/figure-html/unnamed-chunk-6-1.png" width="432" style="display: block; margin: auto;"> The result is an arbitrary dosimetric system with randomly distributed clusters. The Euclidean distance is used to group the clusters (colour code). To use the system in the simulation, instead of providing a scalar as input to <code>clusters</code>, the output of <code><a href="../reference/create_ClusterSystem.html">create_ClusterSystem()</a></code> can be injected in every <code>run_MC</code> function.</p>
<div class="sourceCode" id="cb15"><pre class="downlit">
<span class="fu"><a href="../reference/run_MC_TL_LOC.html">run_MC_TL_LOC</a></span><span class="op">(</span>
 s <span class="op">=</span> <span class="fl">1e14</span>,
 E <span class="op">=</span> <span class="fl">0.9</span>,
 times <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">100</span>,
 b <span class="op">=</span> <span class="fl">1</span>,
 n_filled <span class="op">=</span> <span class="fl">1000</span>,
 method <span class="op">=</span> <span class="st">"seq"</span>,
 clusters <span class="op">=</span> <span class="va">clusters</span>,
 r <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">%&gt;%</span>
<span class="fu"><a href="../reference/plot_RLumCarlo.html">plot_RLumCarlo</a></span><span class="op">(</span><span class="op">)</span></pre></div>
<p><img src="RLumCarlo_-_Getting_started_with_RLumCarlo_files/figure-html/unnamed-chunk-7-1.png" width="480" style="display: block; margin: auto;"></p>
<p>Please note: For the simulation of a dosimetric cluster system, the meaning of <code>n_filled</code> changes. Instead of defining the number of electrons per cluster, it becomes the total number of electrons in the system. Electrons are distributed according to the grouping of the single clusters (the colours in the three-dimensional scatter plot). Within one group, electrons are distributed evenly.</p>
</div>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Bulur_1996rc" class="csl-entry">
Bulur, Enver. 1996. <span>“<span>An Alternative Technique For Optically Stimulated Luminescence (OSL) Experiment</span>.”</span> <em>Radiation Measurements</em> 26 (5): 701–9. <a href="https://doi.org/10.1016/S1350-4487(97)82884-3">https://doi.org/10.1016/S1350-4487(97)82884-3</a>.
</div>
<div id="ref-Chen_2011vn" class="csl-entry">
Chen, R, and Vasilis Pagonis. 2011. <em><span class="nocase">Thermally and Optically Stimulated Luminescence - A Simulation Approach</span></em>. Thermally and Optically Stimulated Luminescence a Simulation Approach. John Wiley <span>&amp;</span> Sons, Ltd.
</div>
<div id="ref-Jain:2012ic" class="csl-entry">
Jain, Mayank, Benny Guralnik, and Martin Thalbitzer Andersen. 2012. <span>“<span class="nocase">Stimulated luminescence emission from localized recombination in randomly distributed defects</span>.”</span> <em>Journal of Physics: Condensed Matter</em> 24 (38): 385402. <a href="https://doi.org/10.1088/0953-8984/24/38/385402">https://doi.org/10.1088/0953-8984/24/38/385402</a>.
</div>
<div id="ref-Pagonis:2019hk" class="csl-entry">
Pagonis, Vasilis, Johannes Friedrich, Michael Discher, Anna Müller-Kirschbaum, Veronika Schlosser, Sebastian Kreutzer, Reuven Chen, and Christoph Schmidt. 2019. <em>Journal of Luminescence</em> 207: 266–72. <a href="https://doi.org/10.1016/j.jlumin.2018.11.024">https://doi.org/10.1016/j.jlumin.2018.11.024</a>.
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Johannes Friedrich, Sebastian Kreutzer, Vasilis Pagonis, Christoph Schmidt.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
