<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Run Monte-Carlo Simulation for TL (localized transitions) — run_MC_TL_LOC • RLumCarlo</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Run Monte-Carlo Simulation for TL (localized transitions) — run_MC_TL_LOC"><meta property="og:description" content="Runs a Monte-Carlo (MC) simulation of thermoluminescence (TL) using
the generalized one trap (GOT) model. Localized transitions refer to transitions
which do not involve the conduction or valence band. These transitions take place between the
ground state and an excited state of the trapped charge, and also involve an energy
state of the recombination centre. The heating rate in this function is assumed to be 1 K/s."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">RLumCarlo</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.9</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/RLumCarlo_-_Getting_started_with_RLumCarlo.html">`RLumCarlo': Tedious features - fine examples</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/R-Lum/RLumCarlo/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Run Monte-Carlo Simulation for TL (localized transitions)</h1>
    <small class="dont-index">Source: <a href="https://github.com/R-Lum/RLumCarlo/blob/HEAD/R/run_MC_TL_LOC.R" class="external-link"><code>R/run_MC_TL_LOC.R</code></a></small>
    <div class="hidden name"><code>run_MC_TL_LOC.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Runs a Monte-Carlo (MC) simulation of thermoluminescence (TL) using
the generalized one trap (GOT) model. Localized transitions refer to transitions
which do not involve the conduction or valence band. These transitions take place between the
ground state and an excited state of the trapped charge, and also involve an energy
state of the recombination centre. The heating rate in this function is assumed to be 1 K/s.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">run_MC_TL_LOC</span><span class="op">(</span></span>
<span>  <span class="va">s</span>,</span>
<span>  <span class="va">E</span>,</span>
<span>  <span class="va">times</span>,</span>
<span>  b <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  clusters <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  n_filled <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  <span class="va">r</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"par"</span>,</span>
<span>  output <span class="op">=</span> <span class="st">"signal"</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>s</dt>
<dd><p><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a> (<strong>required</strong>): The frequency factor of the trap (s^-1)</p></dd>


<dt>E</dt>
<dd><p><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a> (<strong>required</strong>): Thermal activation energy of the trap (eV)</p></dd>


<dt>times</dt>
<dd><p><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a> (<strong>required</strong>): The sequence of temperature steps within the simulation (s).
The default heating rate is set to 1 K/s. The final temperature is <code>max(times) * b</code></p></dd>


<dt>b</dt>
<dd><p><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a> (<em>with default</em>): the heating rate in K/s</p></dd>


<dt>clusters</dt>
<dd><p><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a> (<em>with default</em>): The number of created clusters for the MC runs. The input can be the output of <a href="create_ClusterSystem.html">create_ClusterSystem</a>. In that case <code>n_filled</code> indicate absolute numbers of a system.</p></dd>


<dt>n_filled</dt>
<dd><p><a href="https://rdrr.io/r/base/integer.html" class="external-link">integer</a> (<em>with default</em>): The number of filled electron traps at
the beginning of the simulation (dimensionless). Can be a vector of <code>length(clusters)</code>, shorter values are recycled.</p></dd>


<dt>r</dt>
<dd><p><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a> (<strong>required</strong>): The localized retrapping ratio (dimensionless)</p></dd>


<dt>method</dt>
<dd><p><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a> (<em>with default</em>): Sequential <code>'seq'</code> or parallel <code>'par'</code>processing. In
the parallel mode the function tries to run the simulation on multiple CPU cores (if available) with
a positive effect on the computation time.</p></dd>


<dt>output</dt>
<dd><p><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a> (<em>with default</em>): output is either the <code>'signal'</code> (the default) or
<code>'remaining_e'</code> (the remaining charges/electrons in the trap)</p></dd>


<dt>...</dt>
<dd><p>further arguments, such as <code>cores</code> to control the number of used CPU cores or <code>verbose</code> to silence the terminal</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>This function returns an object of class <code>RLumCarlo_Model_Output</code> which
is a <a href="https://rdrr.io/r/base/list.html" class="external-link">list</a> consisting of an <a href="https://rdrr.io/r/base/array.html" class="external-link">array</a> with dimension length(times) x clusters
and a <a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a> time vector.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p><strong>The model</strong></p>
<p>$$
I_{LOC}(t) = -dn/dt = (s * exp(-E/(k_{B} * T))) * (n^2 / (r + n))
$$</p>
<p>Where in the function: <br>
E := the thermal activation energy (eV) <br>
s := the frequency factor for the trap (s^-1) <br>
t := time (s) <br>
\(k_{B}\) := Boltzmann constant (8.617 x 10^-5 eV K^-1)<br>
T := temperature (°C) <br>
n := the instantaneous number of electrons <br>
r := the retrapping ratio for localized transitions</p>
    </div>
    <div id="function-version">
    <h2>Function version</h2>
    <p>0.1.0</p>
    </div>
    <div id="how-to-cite">
    <h2>How to cite</h2>
    <p>Kreutzer, S., 2022. run_MC_TL_LOC(): Run Monte-Carlo Simulation for TL (localized transitions). Function version 0.1.0. In: Friedrich, J., Kreutzer, S., Pagonis, V., Schmidt, C., 2022. RLumCarlo: Monte-Carlo Methods for Simulating Luminescence Phenomena. R package version 0.1.9. https://CRAN.R-project.org/package=RLumCarlo</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Pagonis, V., Friedrich, J., Discher, M., Müller-Kirschbaum, A., Schlosser, V.,
Kreutzer, S., Chen, R. and Schmidt, C., 2019. Excited state luminescence signals
from a random distribution of defects: A new Monte Carlo simulation approach for feldspar.
Journal of Luminescence 207, 266–272. <a href="https://doi.org/10.1016/j.jlumin.2018.11.024" class="external-link">doi:10.1016/j.jlumin.2018.11.024</a></p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Sebastian Kreutzer, Institute of Geography, Heidelberg University (Germany)</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">## the short example</span></span></span>
<span class="r-in"><span><span class="fu">run_MC_TL_LOC</span><span class="op">(</span></span></span>
<span class="r-in"><span> s <span class="op">=</span> <span class="fl">1e14</span>,</span></span>
<span class="r-in"><span> E <span class="op">=</span> <span class="fl">0.9</span>,</span></span>
<span class="r-in"><span> times <span class="op">=</span> <span class="fl">50</span><span class="op">:</span><span class="fl">100</span>,</span></span>
<span class="r-in"><span> b <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span> method <span class="op">=</span> <span class="st">"seq"</span>,</span></span>
<span class="r-in"><span> clusters <span class="op">=</span> <span class="fl">30</span>,</span></span>
<span class="r-in"><span> r <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">%&gt;%</span></span></span>
<span class="r-in"><span><span class="fu"><a href="plot_RLumCarlo.html">plot_RLumCarlo</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="run_MC_TL_LOC-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="co">## the long (meaningful) example</span></span></span>
<span class="r-in"><span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu">run_MC_TL_LOC</span><span class="op">(</span></span></span>
<span class="r-in"><span> s <span class="op">=</span> <span class="fl">1e14</span>,</span></span>
<span class="r-in"><span> E <span class="op">=</span> <span class="fl">0.9</span>,</span></span>
<span class="r-in"><span> times <span class="op">=</span> <span class="fl">50</span><span class="op">:</span><span class="fl">100</span>,</span></span>
<span class="r-in"><span> method <span class="op">=</span> <span class="st">"par"</span>,</span></span>
<span class="r-in"><span> clusters <span class="op">=</span> <span class="fl">100</span>,</span></span>
<span class="r-in"><span> r <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## plot</span></span></span>
<span class="r-in"><span><span class="fu"><a href="plot_RLumCarlo.html">plot_RLumCarlo</a></span><span class="op">(</span><span class="va">results</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Johannes Friedrich, Sebastian Kreutzer, Vasilis Pagonis, Christoph Schmidt.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer></div>

  


  

  </body></html>

